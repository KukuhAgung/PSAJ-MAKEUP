generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id           Int           @id @default(autoincrement())
  username     String
  email        String        @unique
  password     String?
  phoneNumber  String?
  image        String?
  role         UserRole      @default(USER)
  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @updatedAt
  authProvider AuthProvider?
  reviews      Review[]
  transactions Transaction[]
}

model AuthProvider {
  id             Int      @id @default(autoincrement())
  userId         Int      @unique
  provider       String
  providerUserId String   @unique
  email          String?
  accessToken    String?
  refreshToken   String?
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt
  user           User     @relation(fields: [userId], references: [id])
}

model Product {
  id               Int              @id @default(autoincrement())
  productName      String
  category         String?
  description      String?
  specialTreatment String?
  productServices  ProductService[]
  Transaction      Transaction[]
}

model ProductService {
  id        Int     @id @default(autoincrement())
  productId Int
  feature   String?
  pricelist Int?
  product   Product @relation(fields: [productId], references: [id])
}

model Transaction {
  id         Int      @id @default(autoincrement())
  userId     Int
  productId  Int
  totalPrice Int
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
  Review     Review[]
  product    Product  @relation(fields: [productId], references: [id])
  user       User     @relation(fields: [userId], references: [id])
}

model Review {
  id            Int         @id @default(autoincrement())
  userId        Int
  transactionId Int
  stars         StarRating
  comment       String?
  anonym        Boolean
  createdAt     DateTime    @default(now())
  transaction   Transaction @relation(fields: [transactionId], references: [id])
  user          User        @relation(fields: [userId], references: [id])
}

model Income {
  id            String   @id @default(cuid())
  date          DateTime
  category      String
  totalSales    Int
  amount        Float
  description   String
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
}

model HeroSection {
  id        String   @id @default(cuid())
  imageUrl  String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model ProductSection {
  id        Int      @id @default(autoincrement())
  category  String
  imageUrl  String
  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())
}

model PortfolioSection {
  id        Int      @id @default(autoincrement())
  imageUrl  String
  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())
}

model DescriptionSection {
  id        Int      @id @default(autoincrement())
  videoUrl  String
  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())
}

model HeroProduct {
  id        String   @id @default(cuid())
  imageUrl  String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model ItemProduct {
  id          String          @id @default(cuid())
  title       String
  subtitle    String
  banner      String
  description String
  category    String
  createdAt   DateTime        @default(now())
  updatedAt   DateTime        @updatedAt
  galleryItems GalleryProduct[]
}

model GalleryProduct {
  id        String      @id @default(cuid())
  image     String
  productId String
  product   ItemProduct @relation(fields: [productId], references: [id], onDelete: Cascade)
  createdAt DateTime    @default(now())
  updatedAt DateTime    @updatedAt
}

model HeroGallery {
  id        Int      @id @default(autoincrement())
  imageUrl  String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model GalleryItem {
  id        Int      @id @default(autoincrement())
  imageUrl  String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}


enum UserRole {
  ADMIN
  USER
}

enum StarRating {
  ONE
  TWO
  THREE
  FOUR
  FIVE
}
